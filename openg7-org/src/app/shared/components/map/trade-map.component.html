<div style="position:absolute; inset:0;">
  <mgl-map
    [style]="mapStyle"
    [center]="mapCenter"
    [zoom]="[mapZoom]"
    [renderWorldCopies]="false"
    (mapLoad)="onMapLoad()"
    [style.display]="'block'"
    [style.height.%]="100"
    [style.width.%]="100"
  >
    <mgl-geojson-source id="provinces" [data]="provinceSource()">
      <mgl-layer
        id="provinces-fill"
        type="fill"
        source="provinces"
        [paint]="provinceLayerPaint"
      ></mgl-layer>
    </mgl-geojson-source>

    <mgl-geojson-source id="flows" [data]="flowSource()" [lineMetrics]="true">
      <mgl-layer
        id="flows-glow"
        type="line"
        source="flows"
        [layout]="flowLayerLayout"
        [paint]="flowGlowPaint()"
        data-og7="map-layer"
        data-og7-layer="flows"
      ></mgl-layer>
      <mgl-layer
        id="flows-layer"
        type="line"
        source="flows"
        [layout]="flowLayerLayout"
        [paint]="flowLayerPaint()"
        data-og7="map-layer"
        data-og7-layer="flows"
      ></mgl-layer>
    </mgl-geojson-source>

    <mgl-geojson-source id="markers" [data]="markerSource()">
      <mgl-layer
        id="markers-layer"
        type="circle"
        source="markers"
        [paint]="markerLayerPaint"
        data-og7="map-layer"
        data-og7-layer="markers"
      ></mgl-layer>
    </mgl-geojson-source>

    <ng-container *ngIf="hasHighlight()">
      <mgl-geojson-source id="highlight" [data]="highlightSource()" [lineMetrics]="true">
        <mgl-layer
          id="highlight-layer"
          type="line"
          source="highlight"
          [layout]="highlightLayerLayout"
          [paint]="highlightLayerPaint"
          data-og7="map-layer"
          data-og7-layer="highlight"
        ></mgl-layer>
      </mgl-geojson-source>
    </ng-container>
  </mgl-map>
</div>

<og7-map-legend *ngIf="ready()" data-og7="map-legend"></og7-map-legend>
<!-- <og7-map-kpi-badges *ngIf="ready()" data-og7="map-kpi-badges"></og7-map-kpi-badges> -->
<og7-map-sector-chips *ngIf="ready()" data-og7="map-sector-chips"></og7-map-sector-chips>
<og7-map-basemap-toggle *ngIf="ready()" data-og7="map-basemap-toggle"></og7-map-basemap-toggle>
<og7-map-zoom-control *ngIf="ready()" data-og7="map-zoom-control"></og7-map-zoom-control>
<div
  *ngIf="ready()"
  data-og7="map-tooltip"
  style="position:absolute; right:1.5rem; bottom:1.5rem; min-width:12rem; pointer-events:none;"
></div>
<div
  data-og7="map-aria-live"
  aria-live="polite"
  style="position:absolute; width:1px; height:1px; padding:0; margin:-1px; overflow:hidden; clip:rect(0, 0, 0, 0); white-space:nowrap; border:0;"
></div>
