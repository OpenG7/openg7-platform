<article
  class="opportunity-tile"
  [attr.aria-labelledby]="titleId()"
  [attr.aria-describedby]="scoreId()"
>
  <header class="opportunity-tile__header">
    <div class="opportunity-tile__title-group">
      <h3 class="opportunity-tile__title" [id]="titleId()">{{ vm().title }}</h3>
      <p class="opportunity-tile__subtitle">{{ 'opportunities.timeline.prototypeLabel' | translate }}</p>
    </div>

    <div
      class="opportunity-tile__score"
      role="img"
      [attr.aria-label]="'opportunities.timeline.scoreLabel' | translate:{ value: scoreLabel() }"
      [id]="scoreId()"
    >
      <svg viewBox="0 0 80 80" class="opportunity-tile__score-chart" aria-hidden="true">
        <defs>
          <linearGradient id="opportunity-tile-score-high" x1="0%" y1="0%" x2="100%" y2="100%">
            <stop offset="0%" stop-color="#34d399" />
            <stop offset="100%" stop-color="#22d3ee" />
          </linearGradient>
          <linearGradient id="opportunity-tile-score-medium" x1="0%" y1="0%" x2="100%" y2="100%">
            <stop offset="0%" stop-color="#fbbf24" />
            <stop offset="100%" stop-color="#f97316" />
          </linearGradient>
          <linearGradient id="opportunity-tile-score-low" x1="0%" y1="0%" x2="100%" y2="100%">
            <stop offset="0%" stop-color="#94a3b8" />
            <stop offset="100%" stop-color="#64748b" />
          </linearGradient>
        </defs>
        <circle class="opportunity-tile__score-track" cx="40" cy="40" r="32"></circle>
        <circle
          class="opportunity-tile__score-meter"
          cx="40"
          cy="40"
          r="32"
          [attr.stroke-dasharray]="scoreStrokeDasharray"
          [attr.stroke-dashoffset]="scoreStrokeDashoffset()"
          [attr.stroke]="scoreStroke()"
        ></circle>
        <text x="40" y="46" class="opportunity-tile__score-value" text-anchor="middle">{{ scoreLabel() }}</text>
      </svg>
    </div>
  </header>

  <section class="opportunity-tile__body">
    <div class="opportunity-tile__actor">
      <div class="opportunity-tile__actor-label">{{ 'opportunities.timeline.buyer' | translate }}</div>
      <p class="opportunity-tile__actor-name">{{ vm().buyer.name }}</p>
      <div class="opportunity-tile__chips">
        <span class="opportunity-tile__chip">{{ vm().buyer.provinceLabelKey | translate }}</span>
        <span class="opportunity-tile__chip">{{ vm().buyer.sectorLabelKey | translate }}</span>
      </div>
    </div>

    <div class="opportunity-tile__bridge" aria-hidden="true">
      <svg viewBox="0 0 320 120" class="opportunity-tile__bridge-graphic">
        <path d="M24 86 C 120 16, 200 104, 296 34" class="opportunity-tile__bridge-path"></path>
        <circle cx="24" cy="86" r="8" class="opportunity-tile__bridge-node"></circle>
        <circle cx="296" cy="34" r="8" class="opportunity-tile__bridge-node"></circle>
        <text x="160" y="70" text-anchor="middle" class="opportunity-tile__bridge-distance">{{ distanceLabel() }}</text>
      </svg>
    </div>

    <div class="opportunity-tile__actor opportunity-tile__actor--supplier">
      <div class="opportunity-tile__actor-label">{{ 'opportunities.timeline.supplier' | translate }}</div>
      <p class="opportunity-tile__actor-name">{{ vm().supplier.name }}</p>
      <div class="opportunity-tile__chips">
        <span class="opportunity-tile__chip">{{ vm().supplier.provinceLabelKey | translate }}</span>
        <span class="opportunity-tile__chip">{{ vm().supplier.sectorLabelKey | translate }}</span>
      </div>
    </div>
  </section>

  <footer class="opportunity-tile__actions">
    <button
      type="button"
      class="opportunity-tile__action opportunity-tile__action--primary"
      (click)="emitViewSheet()"
    >
      {{ 'opportunities.timeline.viewSheet' | translate }}
    </button>
    <button
      type="button"
      class="opportunity-tile__action opportunity-tile__action--secondary"
      (click)="emitConnect()"
    >
      {{ 'opportunities.timeline.connect' | translate }}
    </button>
    <button type="button" class="opportunity-tile__action opportunity-tile__action--ghost">
      {{ 'opportunities.timeline.save' | translate }}
    </button>
  </footer>
</article>
