<section
  class="opportunity-compact-kpi"
  [attr.aria-labelledby]="vm().id + '-title'"
>
  <header class="opportunity-compact-kpi__header">
    <p class="opportunity-compact-kpi__eyebrow">{{ 'opportunities.compact.prototypeLabel' | translate }}</p>
    <h3 class="opportunity-compact-kpi__title" [id]="vm().id + '-title'">
      {{ 'opportunities.compact.title' | translate:{ count: vm().items.length } }}
    </h3>
  </header>

  <ol class="opportunity-compact-kpi__list" role="list">
    <li
      class="opportunity-compact-kpi__row"
      role="listitem"
      *ngFor="let item of vm().items; trackBy: trackByItemId"
    >
      <span class="opportunity-compact-kpi__chip opportunity-compact-kpi__chip--sector">
        <span class="opportunity-compact-kpi__chip-icon" aria-hidden="true">{{ item.sectorIcon }}</span>
        <span class="opportunity-compact-kpi__chip-text">{{ item.sectorLabelKey | translate }}</span>
      </span>

      <span class="opportunity-compact-kpi__chip opportunity-compact-kpi__chip--buyer">
        {{ item.buyerName }}
      </span>

      <span class="opportunity-compact-kpi__chip opportunity-compact-kpi__chip--supplier">
        {{ item.supplierName }}
      </span>

      <span
        class="opportunity-compact-kpi__chip opportunity-compact-kpi__chip--score"
        [attr.data-tone]="item.scoreTone"
      >
        {{ 'opportunities.compact.scoreLabel' | translate:{ value: item.scorePercent } }}
      </span>

      <span
        class="opportunity-compact-kpi__chip opportunity-compact-kpi__chip--distance"
        [attr.data-status]="item.distancePending ? 'pending' : 'ready'"
      >
        {{ item.distancePending ? ('opportunities.compact.distancePending' | translate) : item.distanceLabel }}
      </span>

      <button
        type="button"
        class="opportunity-compact-kpi__chip opportunity-compact-kpi__chip--action"
        [attr.aria-label]="
          'opportunities.compact.actionAria' | translate:{ buyer: item.buyerName, supplier: item.supplierName }
        "
        (click)="requestConnect(item.matchId)"
      >
        {{ 'opportunities.timeline.connect' | translate }}
      </button>
    </li>
  </ol>
</section>
