# Strapi workspace overview

This document describes how the official Strapi workspace (`@openg7/strapi`) fits in the monorepo now that the legacy CMS has been sunset.

## Summary table

| Workspace | Location | Strapi generation | Purpose | Owner(s) |
|-----------|----------|-------------------|---------|----------|
| `strapi` | `/strapi` | v5 | Central CMS for companies, exchanges, homepage blocks, feature flags, API tokens, and runtime social/realtime endpoints. Seeds power the public demo content consumed by the Angular app. | Data Platform squad |

## Day-to-day usage

- **Front-end developers** start the CMS locally via `yarn dev:cms` from the repository root. `yarn dev:all` launches both the Angular front-end and Strapi for a full-stack loop.
- **Content editors** use the hosted Strapi admin (`:1337/admin`) to manage content. Provide them with updated API tokens generated by the `08-api-tokens.ts` seed when rotating secrets.
- **API consumers** continue to generate types from `@openg7/contracts`. The package reflects the Strapi v5 schemas and should be regenerated with `yarn codegen` whenever Strapi content-types evolve.

## Operational checklist

- Any new collection or component must land directly in `strapi`. Avoid resurrecting the legacy workspace or duplicating schemas.
- Keep `.env.example` and infrastructure notes in sync with required environment variables (`STRAPI_ADMIN_*`, `STRAPI_SEED_ADMIN_ALLOWED`, `STRAPI_API_READONLY_TOKEN`, etc.) so new contributors can bootstrap quickly.
- Seeds must stay idempotent. Use `yarn workspace @openg7/strapi seed:dev` (or `yarn dev:cms` which runs them on bootstrap) after schema changes to ensure demo content and API tokens are recreated when missing.

## Next steps

- Extend the automated smoke tests to cover critical Strapi endpoints before every release (`/api/feed/highlights`, `/api/corridors/realtime`, `/api/connections` included).
- Document migrations (content-type updates, breaking API changes) under `docs/strapi/` so the Angular team can align their GraphQL/REST clients.
- Keep the `strapi` workspace lean: delete obsolete components promptly and remove leftover references to the legacy CMS when you find them in scripts or documentation.
